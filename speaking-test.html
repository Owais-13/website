<!DOCTYPE html>
<html lang="en">
<head>
    <title>IELTS Speaking Test - AI Powered Scoring</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/aos.css">
    <link rel="stylesheet" href="css/ionicons.min.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .timer {
            position: fixed;
            top: 100px;
            right: 20px;
            background: #007bff;
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            font-size: 20px;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }
        
        .speaking-area {
            margin-top: 30px;
        }
        
        .question-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .cue-card {
            background: #fff3cd;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #ffeaa7;
        }
        
        .cue-card h4 {
            color: #856404;
            margin-bottom: 20px;
        }
        
        .cue-card ul {
            margin-left: 20px;
            margin-bottom: 0;
        }
        
        .cue-card li {
            margin-bottom: 10px;
        }
        
        .response-input {
            margin-top: 20px;
        }
        
        textarea.form-control {
            min-height: 200px;
            font-size: 16px;
            line-height: 1.8;
        }
        
        .score-results {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .criterion-score {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 50px;
        }
        
        .loading-spinner i {
            font-size: 50px;
            color: #007bff;
        }
        
        .part-selector {
            margin-bottom: 30px;
        }
        
        .part-selector .card {
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .part-selector .card:hover {
            border-color: #007bff;
            transform: translateY(-5px);
        }
        
        .part-selector .card.selected {
            border-color: #007bff;
            background: #e7f3ff;
        }
        
        .question-nav {
            margin-top: 30px;
            text-align: center;
        }
        
        .question-nav button {
            margin: 0 10px;
        }
        
        .progress {
            height: 30px;
            margin-bottom: 30px;
        }
        
        .progress-bar {
            font-size: 14px;
            line-height: 30px;
        }
        
        .prep-timer {
            background: #ffc107;
            color: #000;
            padding: 10px 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: bold;
            display: inline-block;
        }
        
        .recording-indicator {
            color: #dc3545;
            font-weight: bold;
            display: none;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .recording-indicator i {
            margin-right: 10px;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .badge {
            font-size: 18px;
            padding: 8px 15px;
        }
        
        .feedback {
            margin-top: 10px;
            color: #555;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="bg-top navbar-light">
        <div class="container">
            <div class="row no-gutters d-flex align-items-center align-items-stretch">
                <div class="col-md-4 d-flex align-items-center py-4">
                    <a class="navbar-brand" href="index.html">VisaFluent</a>
                </div>
                <div class="col-lg-8 d-block">
                    <div class="row d-flex">
                        <div class="col-md d-flex topper align-items-center align-items-stretch py-md-4">
                            <div class="icon d-flex justify-content-center align-items-center"><span class="icon-paper-plane"></span></div>
                            <div class="text">
                                <span>Email</span>
                                <span>info@ieltsmaster.com</span>
                            </div>
                        </div>
                        <div class="col-md d-flex topper align-items-center align-items-stretch py-md-4">
                            <div class="icon d-flex justify-content-center align-items-center"><span class="icon-phone2"></span></div>
                            <div class="text">
                                <span>Call</span>
                                <span>Call Us: + 1235 2355 98</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark ftco-navbar-light" id="ftco-navbar">
        <div class="container d-flex align-items-center px-4">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav">
                <span class="oi oi-menu"></span> Menu
            </button>
            <div class="collapse navbar-collapse" id="ftco-nav">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item"><a href="index.html" class="nav-link pl-0">Home</a></li>
                    <li class="nav-item"><a href="about.html" class="nav-link">About</a></li>
                    <li class="nav-item"><a href="courses.html" class="nav-link">Courses</a></li>
                    <li class="nav-item active"><a href="practice.html" class="nav-link">Practice</a></li>
                    <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <section class="hero-wrap hero-wrap-2" style="background-image: url('images/bg_1.jpg');">
        <div class="overlay"></div>
        <div class="container">
            <div class="row no-gutters slider-text align-items-center justify-content-center">
                <div class="col-md-9 ftco-animate text-center">
                    <h1 class="mb-2 bread">IELTS Speaking Test</h1>
                    <p class="breadcrumbs">
                        <span class="mr-2"><a href="index.html">Home <i class="ion-ios-arrow-forward"></i></a></span>
                        <span class="mr-2"><a href="practice.html">Practice <i class="ion-ios-arrow-forward"></i></a></span>
                        <span>Speaking Test <i class="ion-ios-arrow-forward"></i></span>
                    </p>
                </div>
            </div>
        </div>
    </section>
    
    <div class="timer" id="timer">00:00</div>
    
    <section class="ftco-section">
        <div class="container">
            <div class="test-container">
                <h2 class="text-center mb-5">IELTS Speaking Test with AI Scoring</h2>
                
                <!-- Part Selection -->
                <div id="part-selection">
                    <h4 class="mb-4">Select Speaking Test Part:</h4>
                    <div class="row part-selector">
                        <div class="col-md-4">
                            <div class="card" onclick="selectPart(1)">
                                <div class="card-body text-center">
                                    <h3 class="card-title">Part 1</h3>
                                    <p class="card-text">Introduction & Interview</p>
                                    <p class="text-muted">4-5 minutes</p>
                                    <p>Answer questions about familiar topics</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" onclick="selectPart(2)">
                                <div class="card-body text-center">
                                    <h3 class="card-title">Part 2</h3>
                                    <p class="card-text">Individual Long Turn</p>
                                    <p class="text-muted">3-4 minutes</p>
                                    <p>Speak about a topic for 1-2 minutes</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" onclick="selectPart(3)">
                                <div class="card-body text-center">
                                    <h3 class="card-title">Part 3</h3>
                                    <p class="card-text">Two-way Discussion</p>
                                    <p class="text-muted">4-5 minutes</p>
                                    <p>Discuss abstract ideas and issues</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <button class="btn btn-primary btn-lg" onclick="startSpeakingTest()" disabled id="start-button">
                            <i class="icon-play"></i> Start Test
                        </button>
                    </div>
                </div>
                
                <!-- Test Area -->
                <div id="test-area" style="display: none;">
                    <!-- Progress Bar -->
                    <div class="progress" id="progress-bar" style="display: none;">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%">
                            Question 1 of 5
                        </div>
                    </div>
                    
                    <!-- Part 1 Questions -->
                    <div id="part1-questions" style="display: none;">
                        <div class="question-card">
                            <h4 id="part1-topic">Topic: </h4>
                            <h5 id="part1-question">Question will appear here</h5>
                            <div class="response-input">
                                <label>Your Answer (Type your response):</label>
                                <textarea class="form-control" id="part1-response" placeholder="Type your answer here..."></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Part 2 Cue Card -->
                    <div id="part2-cuecard" style="display: none;">
                        <div class="prep-timer" id="prep-timer" style="display: none;">
                            Preparation Time: <span id="prep-time">60</span> seconds
                        </div>
                        <div class="cue-card">
                            <h4>Cue Card</h4>
                            <p id="part2-topic"></p>
                            <p><strong>You should say:</strong></p>
                            <ul id="part2-points">
                                <!-- Points will be added here -->
                            </ul>
                            <p class="mt-3" id="part2-followup"></p>
                        </div>
                        <div class="response-input">
                            <div class="recording-indicator">
                                <i class="icon-circle"></i> Speaking Time (1-2 minutes)
                            </div>
                            <label>Your Response (Type your answer):</label>
                            <textarea class="form-control" id="part2-response" placeholder="Type your response here..." style="min-height: 300px;"></textarea>
                        </div>
                    </div>
                    
                    <!-- Part 3 Questions -->
                    <div id="part3-questions" style="display: none;">
                        <div class="question-card">
                            <h4 id="part3-topic">Discussion Topic: </h4>
                            <h5 id="part3-question">Question will appear here</h5>
                            <div class="response-input">
                                <label>Your Answer (Type your response):</label>
                                <textarea class="form-control" id="part3-response" placeholder="Type your answer here..." style="min-height: 250px;"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Navigation -->
                    <div class="question-nav">
                        <button class="btn btn-secondary" onclick="previousQuestion()" id="prev-button" style="display: none;">
                            <i class="icon-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()" id="next-button">
                            Next <i class="icon-arrow-right"></i>
                        </button>
                        <button class="btn btn-success" onclick="submitTest()" id="submit-button" style="display: none;">
                            <i class="icon-check"></i> Submit Test
                        </button>
                    </div>
                </div>
                
                <!-- Loading Spinner -->
                <div class="loading-spinner" id="loading-spinner">
                    <i class="icon-spinner icon-spin"></i>
                    <h4 class="mt-3">AI is analyzing your responses...</h4>
                    <p>This may take a few seconds</p>
                </div>
                
                <!-- Results Area -->
                <div id="results-area" style="display: none;">
                    <!-- Results will be displayed here -->
                </div>
                
                <div class="text-center mt-4" id="restart-button" style="display: none;">
                    <button class="btn btn-primary" onclick="restartTest()">
                        <i class="icon-refresh"></i> Take Another Test
                    </button>
                </div>
            </div>
        </div>
    </section>
    
    <footer class="ftco-footer ftco-bg-dark ftco-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-center">
                    <p>Copyright &copy; 2024 VisaFluent. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-migrate-3.0.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.stellar.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/jquery.animateNumber.min.js"></script>
    <script src="js/scrollax.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/openai-config.js"></script>
    <script src="js/ielts-scoring.js"></script>
    
    <script>
        let selectedPart = null;
        let currentQuestion = 0;
        let questions = [];
        let responses = {};
        let timer;
        let prepTimer;
        
        // Sample questions for each part
        const sampleQuestions = {
            part1: {
                topics: [
                    {
                        topic: "Work and Studies",
                        questions: [
                            "Do you work or are you a student?",
                            "What do you like about your job/studies?",
                            "What would you like to change about your work/studies?",
                            "What are your future career plans?",
                            "Do you prefer working alone or with others?"
                        ]
                    },
                    {
                        topic: "Hometown",
                        questions: [
                            "Where is your hometown?",
                            "What do you like about your hometown?",
                            "How has your hometown changed in recent years?",
                            "Would you like to live there in the future?",
                            "What would you recommend a visitor to see in your hometown?"
                        ]
                    }
                ]
            },
            part2: {
                cueCards: [
                    {
                        topic: "Describe a memorable journey you have taken",
                        points: [
                            "Where you went",
                            "Who you went with",
                            "What you did during the journey",
                            "Why it was memorable"
                        ],
                        followUp: "And explain how you felt about this journey."
                    },
                    {
                        topic: "Describe a skill you would like to learn",
                        points: [
                            "What the skill is",
                            "Why you want to learn it",
                            "How you would learn it",
                            "How difficult you think it would be"
                        ],
                        followUp: "And explain how this skill would benefit you."
                    }
                ]
            },
            part3: {
                topics: [
                    {
                        topic: "Travel and Tourism",
                        questions: [
                            "How has tourism changed in your country over the past few decades?",
                            "What are the positive and negative impacts of tourism on local communities?",
                            "Do you think virtual reality will replace actual travel in the future?",
                            "How can countries balance economic benefits of tourism with environmental protection?",
                            "What role does social media play in modern tourism?"
                        ]
                    },
                    {
                        topic: "Education and Skills",
                        questions: [
                            "How important are practical skills compared to academic knowledge?",
                            "Should education systems focus more on developing creativity?",
                            "What skills will be most important in the future job market?",
                            "How has technology changed the way people learn new skills?",
                            "Is lifelong learning becoming more important in modern society?"
                        ]
                    }
                ]
            }
        };
        
        function selectPart(part) {
            selectedPart = part;
            $('.part-selector .card').removeClass('selected');
            $(`.part-selector .card:eq(${part - 1})`).addClass('selected');
            $('#start-button').prop('disabled', false);
        }
        
        function startSpeakingTest() {
            $('#part-selection').hide();
            $('#test-area').show();
            
            // Initialize questions based on selected part
            if (selectedPart === 1) {
                const topicSet = sampleQuestions.part1.topics[Math.floor(Math.random() * sampleQuestions.part1.topics.length)];
                questions = topicSet.questions.map((q, i) => ({
                    question: q,
                    topic: topicSet.topic,
                    index: i
                }));
                $('#part1-questions').show();
                $('#progress-bar').show();
                showPart1Question();
            } else if (selectedPart === 2) {
                const cueCard = sampleQuestions.part2.cueCards[Math.floor(Math.random() * sampleQuestions.part2.cueCards.length)];
                questions = [cueCard];
                showPart2CueCard();
            } else if (selectedPart === 3) {
                const topicSet = sampleQuestions.part3.topics[Math.floor(Math.random() * sampleQuestions.part3.topics.length)];
                questions = topicSet.questions.map((q, i) => ({
                    question: q,
                    topic: topicSet.topic,
                    index: i
                }));
                $('#part3-questions').show();
                $('#progress-bar').show();
                showPart3Question();
            }
        }
        
        function showPart1Question() {
            const question = questions[currentQuestion];
            $('#part1-topic').text(`Topic: ${question.topic}`);
            $('#part1-question').text(question.question);
            $('#part1-response').val(responses[`part1_${currentQuestion}`] || '');
            updateProgress();
            updateNavButtons();
        }
        
        function showPart2CueCard() {
            const cueCard = questions[0];
            $('#part2-cuecard').show();
            $('#part2-topic').text(cueCard.topic);
            $('#part2-points').html(cueCard.points.map(p => `<li>${p}</li>`).join(''));
            $('#part2-followup').text(cueCard.followUp);
            $('#part2-response').val(responses['part2'] || '');
            
            // Start preparation timer
            startPrepTimer();
            updateNavButtons();
        }
        
        function showPart3Question() {
            const question = questions[currentQuestion];
            $('#part3-topic').text(`Discussion Topic: ${question.topic}`);
            $('#part3-question').text(question.question);
            $('#part3-response').val(responses[`part3_${currentQuestion}`] || '');
            updateProgress();
            updateNavButtons();
        }
        
        function startPrepTimer() {
            $('#prep-timer').show();
            let prepTime = 60;
            
            prepTimer = setInterval(() => {
                prepTime--;
                $('#prep-time').text(prepTime);
                
                if (prepTime <= 0) {
                    clearInterval(prepTimer);
                    $('#prep-timer').hide();
                    $('.recording-indicator').show();
                    // Start speaking timer
                    startSpeakingTimer();
                }
            }, 1000);
        }
        
        function startSpeakingTimer() {
            $('#timer').show();
            let seconds = 0;
            
            timer = setInterval(() => {
                seconds++;
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                $('#timer').text(`${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`);
                
                if (seconds >= 120) { // 2 minutes max
                    $('#timer').css('background', '#dc3545');
                }
            }, 1000);
        }
        
        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            $('.progress-bar').css('width', `${progress}%`);
            $('.progress-bar').text(`Question ${currentQuestion + 1} of ${questions.length}`);
        }
        
        function updateNavButtons() {
            $('#prev-button').toggle(currentQuestion > 0);
            $('#next-button').toggle(currentQuestion < questions.length - 1);
            $('#submit-button').toggle(currentQuestion === questions.length - 1);
        }
        
        function saveCurrentResponse() {
            if (selectedPart === 1) {
                responses[`part1_${currentQuestion}`] = $('#part1-response').val();
            } else if (selectedPart === 2) {
                responses['part2'] = $('#part2-response').val();
            } else if (selectedPart === 3) {
                responses[`part3_${currentQuestion}`] = $('#part3-response').val();
            }
        }
        
        function previousQuestion() {
            saveCurrentResponse();
            currentQuestion--;
            
            if (selectedPart === 1) {
                showPart1Question();
            } else if (selectedPart === 3) {
                showPart3Question();
            }
        }
        
        function nextQuestion() {
            saveCurrentResponse();
            currentQuestion++;
            
            if (selectedPart === 1) {
                showPart1Question();
            } else if (selectedPart === 3) {
                showPart3Question();
            }
        }
        
        async function submitTest() {
            saveCurrentResponse();
            
            // Clear timers
            if (timer) clearInterval(timer);
            if (prepTimer) clearInterval(prepTimer);
            
            // Validate responses
            const hasResponses = Object.values(responses).some(r => r && r.trim());
            if (!hasResponses) {
                alert('Please provide at least one response before submitting.');
                return;
            }
            
            // Show loading
            $('#test-area').hide();
            $('#loading-spinner').show();
            
            try {
                // Score each response
                const scores = [];
                
                if (selectedPart === 1) {
                    for (let i = 0; i < questions.length; i++) {
                        if (responses[`part1_${i}`]) {
                            const score = await ieltsScoring.scoreSpeakingResponse(
                                questions[i].question,
                                responses[`part1_${i}`],
                                1
                            );
                            scores.push(score);
                        }
                    }
                } else if (selectedPart === 2) {
                    if (responses['part2']) {
                        const score = await ieltsScoring.scoreSpeakingResponse(
                            questions[0].topic,
                            responses['part2'],
                            2
                        );
                        scores.push(score);
                    }
                } else if (selectedPart === 3) {
                    for (let i = 0; i < questions.length; i++) {
                        if (responses[`part3_${i}`]) {
                            const score = await ieltsScoring.scoreSpeakingResponse(
                                questions[i].question,
                                responses[`part3_${i}`],
                                3
                            );
                            scores.push(score);
                        }
                    }
                }
                
                // Calculate average scores
                const avgScore = calculateAverageScores(scores);
                
                // Display results
                $('#loading-spinner').hide();
                $('#results-area').html(formatSpeakingResults(avgScore, scores)).show();
                $('#restart-button').show();
                $('#timer').hide();
                
            } catch (error) {
                $('#loading-spinner').hide();
                alert('Error scoring your responses. Please check your API key configuration and try again.');
                console.error(error);
                restartTest();
            }
        }
        
        function calculateAverageScores(scores) {
            if (!scores.length) return null;
            
            const avgScores = {
                fluencyCoherence: 0,
                lexicalResource: 0,
                grammaticalRange: 0,
                pronunciation: 0,
                overallScore: 0
            };
            
            scores.forEach(score => {
                if (!score.error) {
                    avgScores.fluencyCoherence += score.fluencyCoherence.score;
                    avgScores.lexicalResource += score.lexicalResource.score;
                    avgScores.grammaticalRange += score.grammaticalRange.score;
                    avgScores.pronunciation += score.pronunciation.score;
                    avgScores.overallScore += score.overallScore;
                }
            });
            
            const validScores = scores.filter(s => !s.error).length;
            if (validScores > 0) {
                Object.keys(avgScores).forEach(key => {
                    avgScores[key] = (avgScores[key] / validScores).toFixed(1);
                });
            }
            
            return avgScores;
        }
        
        function formatSpeakingResults(avgScore, individualScores) {
            let html = '<div class="score-results">';
            html += `<h3 class="mb-4">Your IELTS Speaking Score: <span class="badge badge-primary">${avgScore.overallScore}</span></h3>`;
            
            html += '<div class="score-breakdown mb-4">';
            html += `
                <div class="criterion-score">
                    <h5>Fluency and Coherence: <span class="badge badge-secondary">${avgScore.fluencyCoherence}</span></h5>
                </div>
                <div class="criterion-score">
                    <h5>Lexical Resource: <span class="badge badge-secondary">${avgScore.lexicalResource}</span></h5>
                </div>
                <div class="criterion-score">
                    <h5>Grammatical Range and Accuracy: <span class="badge badge-secondary">${avgScore.grammaticalRange}</span></h5>
                </div>
                <div class="criterion-score">
                    <h5>Pronunciation (Text-based estimate): <span class="badge badge-secondary">${avgScore.pronunciation}</span></h5>
                </div>
            `;
            html += '</div>';
            
            // Show detailed feedback for each response
            html += '<h4 class="mb-3">Detailed Feedback:</h4>';
            individualScores.forEach((score, index) => {
                if (!score.error) {
                    html += `
                        <div class="criterion-score">
                            <h5>Response ${index + 1} - Score: ${score.overallScore}</h5>
                            <p class="feedback">${score.generalFeedback}</p>
                            ${score.improvements && score.improvements.length > 0 ? `
                                <p class="mt-2"><strong>Suggestions:</strong></p>
                                <ul>
                                    ${score.improvements.map(imp => `<li>${imp}</li>`).join('')}
                                </ul>
                            ` : ''}
                        </div>
                    `;
                }
            });
            
            html += '</div>';
            return html;
        }
        
        function restartTest() {
            // Clear timers
            if (timer) clearInterval(timer);
            if (prepTimer) clearInterval(prepTimer);
            
            // Reset state
            selectedPart = null;
            currentQuestion = 0;
            questions = [];
            responses = {};
            
            // Reset UI
            $('#part-selection').show();
            $('#test-area').hide();
            $('#results-area').hide();
            $('#restart-button').hide();
            $('#loading-spinner').hide();
            $('#timer').hide().text('00:00').css('background', '#007bff');
            
            // Hide all test sections
            $('#part1-questions').hide();
            $('#part2-cuecard').hide();
            $('#part3-questions').hide();
            $('#progress-bar').hide();
            
            // Clear selections
            $('.part-selector .card').removeClass('selected');
            $('#start-button').prop('disabled', true);
            
            // Clear text areas
            $('textarea').val('');
            
            // Reset indicators
            $('.recording-indicator').hide();
            $('#prep-timer').hide();
        }
    </script>
</body>
</html>